<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yxb.user.mapper.UserMapper">

    <select id="selectByUsername" resultType="com.yxb.user.domain.entity.User">
        SELECT * FROM user_info WHERE username = #{username} AND deleted = 0
    </select>

    <select id="selectByPhone" resultType="com.yxb.user.domain.entity.User">
        SELECT * FROM user_info WHERE phone = #{phone} AND deleted = 0
    </select>

    <update id="addPoints">
        UPDATE user_info SET points = points + #{points}, update_time = NOW() 
        WHERE id = #{userId} AND deleted = 0
    </update>

    <update id="addStudyTime">
        UPDATE user_info SET total_study_minutes = total_study_minutes + #{minutes}, update_time = NOW() 
        WHERE id = #{userId} AND deleted = 0
    </update>

    <update id="addStudyDays">
        UPDATE user_info SET total_study_days = total_study_days + #{days}, update_time = NOW() 
        WHERE id = #{userId} AND deleted = 0
    </update>

</mapper>
